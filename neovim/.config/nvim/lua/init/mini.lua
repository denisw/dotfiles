-------------------------------------------------------------------------------
-- Clone mini.nvim
-------------------------------------------------------------------------------

-- Clone 'mini.nvim'
local path_package = vim.fn.stdpath("data") .. "/site/"
local mini_path = path_package .. "pack/deps/start/mini.nvim"
if not vim.loop.fs_stat(mini_path) then
  vim.cmd('echo "Installing `mini.nvim`" | redraw')
  local clone_cmd = {
    "git",
    "clone",
    "--filter=blob:none",
    "https://github.com/nvim-mini/mini.nvim",
    mini_path,
  }
  vim.fn.system(clone_cmd)
  vim.cmd("packadd mini.nvim | helptags ALL")
  vim.cmd('echo "Installed `mini.nvim`" | redraw')
end

-------------------------------------------------------------------------------
-- mini.bufremove
-------------------------------------------------------------------------------

require("mini.bufremove").setup()

-------------------------------------------------------------------------------
-- mini.deps
-------------------------------------------------------------------------------

require("mini.deps").setup({
  path = {
    package = path_package,
  },
})

-------------------------------------------------------------------------------
-- mini.git
-------------------------------------------------------------------------------

require("mini.git").setup()

-------------------------------------------------------------------------------
-- mini.diff
-------------------------------------------------------------------------------

require("mini.diff").setup({
  view = {
    style = "sign",
  },
})

vim.keymap.set("n", "<leader>gd", MiniDiff.toggle_overlay)

-------------------------------------------------------------------------------
-- mini.pairs
-------------------------------------------------------------------------------

require("mini.pairs").setup()

-------------------------------------------------------------------------------
-- mini.pick
-------------------------------------------------------------------------------

require("mini.pick").setup()

-------------------------------------------------------------------------------
-- mini.statusline
-------------------------------------------------------------------------------

require("mini.statusline").setup()

-------------------------------------------------------------------------------
-- mini.surround
-------------------------------------------------------------------------------

require("mini.surround").setup()

-------------------------------------------------------------------------------
-- mini.trailspace
-------------------------------------------------------------------------------

require("mini.trailspace").setup()

vim.api.nvim_create_autocmd("BufWritePre", {
  callback = function()
    require("mini.trailspace").trim()
  end,
})
